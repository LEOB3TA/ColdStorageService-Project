<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<!--
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<link rel="stylesheet" type="text/css" href="resources/css/sprint0.css">

<head>

    <title>Sprint0</title></head>

<body>
<!--
<div id="top">
    <h1><b>PROGETTO DI INGEGNERIA DEI SISTEMI SOFTWARE</b> - SPRINT 0 <font size="5"></font></h1>
    <h3>Gruppo di lavoro: Focardi, Galeone, Porrazzo <font size="3"></font></h3>
</div>
-->
<div class="body">
    <h2>Introduction</h2>
    <div class="remark"> Progetto finale di ISS, finalizzato allo sviluppo software di un magazzino refrigerato, nel
        quale
        vi &egrave; un robot che ha il compito di trasportare del cibo da un punto di partenza - chiamato INDOOR - alla cella
        frigorifera.
    </div>

    <h2>Requirements</h2>
    <div class="remark">
        <a href="https://htmlpreview.github.io/?https://github.com/anatali/issLab23/blob/main/iss23Material/html/TemaFinale23.html">Tema Finale </a>
    </div>

    <h3>Work plan</h3>
    <div class="remark">
        <ul>
            <li>A partire dallo sprint0 analizzare il core business dell'applicazione</li>
            <li>Trovare ad analizzare eventuali criticit&agrave; dei requisiti</li>
            <li>Implementare un <b>MockTruck</b> in modo da simulare un interazione del driver con la <b>ServiceAccessGui</b>, che interagisca con il <b>ColdStorageService</b></li>
            <li>Implementare il <b>ColdStorageService</b></li>
            <li>Implementare il <b>TrasportTrolley</b> e interfacciarlo con il <b>BasicRobot</b></li>
            <li>Testing del sistema</li>
            <li>Aggregare le varie componenti in modo da creare un primo prototipo del sistema</li>
        </ul>
    </div>

    <h2>Problem analysis</h2>
    <div class="remark">
        <h3>MockTruck</h3>
        <h5>Obiettivo</h5>
        Sviluppare un attore che simuli un driver che:
        <br>
        <ol>
            <li>Richieda un <b>Ticket</b></li>
            <li>Si rechi alla <b>INDOOR</b></li>
            <li>Presenti il ticket al <b>ColdStorageService</b> e attenda la risposta</li>
        </ol>
        <h5>Problemi</h5>
        Analizzando il testo dei requisiti possiamo dedurre i seguenti problemi:
        <br>
        <ol>
            <li><b>La richiesta del ticket e la presentazione del ticket avvengono in istanti di tempo diversi</b></li>
            Dai requisiti forniti dal committente si evince che la richiesta di immagazzinamento del cibo e l'effettivo arrivo alla <b>INDOOR</b>, se la richiesta viene accettata, avvengono in due momenti distinti.
            <li><b>Scadenza del ticket</b></li>
            Nel caso di richiesta accettata al driver viene fornito un ticket a cui &egrave; associata una scadenza entro la quale il driver deve recarsi presso l'<b>INDOOR</b>; di conseguenza &egrave; emerso un dubbio sul fatto che il driver debba conoscere o meno tale scadenza.
            <li><b>Problema del load-time lungo</b></li>
            Quando il driver presenta il ticket &egrave; possibile che il <b>ColdStorageService</b> non riesca a fornire la risposta <b>chargeTaken</b> in tempi brevi, in quanto il <b>TrasportTrolley</b> potrebbe essere occupato, quindi il driver non saprebbe se la sua richiesta &egrave; in attesa di una risposta oppure se il ticket non &egrave; stato accettato.
            <li><b>Errore interno del ColdStorageService</b></li>
            Se il <b>ColdStorageService</b> ha degli errori interni che implicano un down del servizio, come reagisce il driver.
            <li><b>Quando il driver deve liberare la indoor</b></li>
            Il driver deve liberare la <b>INDOOR</b> appena "as soon as possible" cio&egrave; appena preso il carico, oppure deve aspettare che il carico sia stato scaricato all'interno della <b>ColdRoom</b>
        </ol>
        <h5>Possibili soluzioni</h5>
        <ol>
            <li><b>La richiesta del ticket e la presentazione del ticket avvengono in istanti di tempo diversi</b></li>
            Il tempo in cui il driver si reca alla <b>INDOOR</b> non &egrave; trascurabile, di conseguenza &egrave; necessario introdurre una variabile <b>DT</b> (driver time) che rappresenta il tempo di viaggio.
            <li><b>Scadenza del ticket</b></li>
           Se al driver fosse fornita la scadenza del ticket e supponendo che il driver conosca una stima del tempo di viaggio fino alla <b>INDOOR</b>, gli consentirebbe di decidere se intraprendere il viaggio o meno. In caso contrario, al driver verrebbe fornito solamente il <b>TICKETID</b>, di conseguenza si recherebbe sempre alla <b>INDOOR</b> dove avverrebbe poi il controllo sulla validit&agrave; del ticket.
            Durante questa fase di sviluppo &egrave; stata adottata la seconda scelta, comunque sono necessarie delle ulteriori informazioni da parte del committente.
            <li><b>Problema del load-time lungo</b></li>
            Per sopperire a questo problema &egrave; necessario creare un interazione a due fasi: una in cui il driver presenta il proprio ticket (<b>sendTicket</b>) e riceve una risposta da parte del ColdStorageService (<b>ticketAccepted/ticketRejected</b>); e una in cui il driver invia la richiesta di deposito (<b>deposit</b>) e riceve poi <b>chargeTaken</b>
            <li><b>Errore interno del ColdStorageService</b></li>
            &Egrave; possibile introdurre un timeout per ogni richiesta, in modo che il driver abbandoni alla scadenza del timer. Il timer &egrave; stato fissato a <b>60</b> secondi.
            <li><b>Quando il driver deve liberare la indoor</b></li>
            In questa fase di sviluppo &egrave; stato adottato l'approccio "as soon as possible"
        </ol>
    </div>

    <h2>Architettura Logica</h2>
     <div class="remark">
             <br>
         Modello: <a style="font-size: larger" href="https://github.com/LEOB3TA/issProject2023/blob/main/Sprint1/src/sprint1.qak" target="_blank">sprint1.qak</a> <!-- TODO fare il modello completo -->
         <br>
             <img src="./resources/images/coldstorageservicearch.png" alt="architettura logica"> <!-- TODO inserire l'immagine corretta-->

     </div>


       <!--  <h2>Piano di lavoro</h2>

         </div> -->

             <h2>Project</h2>
              <div class="remark">
                  <h3>MockTruck</h3>
                  Il MockTruck &egrave; stato modellato come un <b>Attore Qak</b>, si compone di diversi stati che vengono ripetuti ciclicamente, in modo da rispettare l'obiettivo di simulare un driver che interagisce con la <b>ServiceAccessGUI</b><br>
                  Il comportamento creato non implica pi&ugrave; driver contemporanei ma solo uno che tenta il deposito ciclicamente.<br>
                  In seguito viene riportato il diagramma degli stati.<br>
                  <img src="./resources/images/MockTruckState.drawio.png" alt="MockTruckState">
                  <br>
                  Gli stati che rappresentato un rifiuto o un errore del sistema (Rejected, HandleError, handleTicketExpired), stampano degli errori e ripetono il ciclo.<br>
                  La transizione tra lo stato <b>Accepted</b> e <b>SendTicket</b> rappresenta il viaggio che deve compiere il driver per arrivare alla <b>INDOOR</b>.<br>
                  Lo stato <b>SendDeposit</b> implementa l'approccio "as soon as possible" descritto nell'analisi del problema, quindi al momento della ricezione del messaggio <b>chargeTaken</b> il driver abbandona l'indoor.
                  Prima di ripere il ciclo, all'interno dello stato <b>IDLE</b> &egrave; presente una sleep.
                  <pre>
Thread.sleep(Random.nextLong(1, 2001))
                  </pre>
                  <br>
                  Sono presenti tre variabili che vengono modificate a ogni ciclo.
                  <pre>
var FW = 0
var DT = 1000L
var TICKETID = 0
                  </pre>
                  In particolare, le variabili <b>FW</b> e <b>DT</b> vengono inizializzate a dei valori casuali attraverso una funzione all'interno dello stato <b>IDLE</b>:
                  <pre>
fun initDriver(){
    FW =  Random.nextInt(1, 101)
    DT = Random.nextLong(1, 2001)
}
                  </pre>
                  Invece la variabile <b>TICKETID</b> viene assegnata all'interno dello stato <b>Accepted</b>, prendendo il valore dalla risposta <b>storeAccepted</b>
                  <pre>
onMsg (storeAccepted : storeAccepted(TICKETID)){
   		[#
   			TICKETID = payloadArg(0).toInt()
   		#]
}
                  </pre>
             </div>

         <h2>Testing</h2>
         <div class="remark">
             <h3>MockTruck</h3>

         </div>

<!--
         <h2>Deployment</h2>
         <div class="remark">

         </div>


         <h2>Maintenance</h2>
         -->
<!-- USEFUL
<table style="width:100%" border="1">
<tr>
<td style="width:40%">
</td>
<td></td>
</tr>
</table>
-->

<br/><br/>
</div>

<div class="stud">
    By Students: <br>
    <div class="studentCardRow">
    <div class="studentCard">
        <div class="studentName">Leonardo Focardi</div>
        <div class="studentEmail"><a href= "mailto:leonardo.focardi@studio.unibo.it">leonardo.focardi@studio.unibo.it</a>
            </div>
        <div class="studentImg"><img class="studentAvatar" src="./resources/boys/leo.jpg"></div>
    </div>
        <div class="studentCard">
            <div class="studentName">Christian Galeone</div>
            <div class="studentEmail"><a href= "mailto:christian.galeone@studio.unibo.it">christian.galeone@studio.unibo.it</a></div>
            <div class="studentImg"><img class="studentAvatar" src="./resources/boys/christian.jpg"></div>
        </div>
        <div class="studentCard">
            <div class="studentName">Gianmiriano Porrazzo</div>
            <div class="studentEmail"><a href= "mailto:gianmiriano.porrazzo@studio.unibo.it">gianmiriano.porrazzo@studio.unibo.it</a></div>
            <div class="studentImg"><img class="studentAvatar" src="./resources/boys/gian.jpg"></div>
        </div>
    </div>

    <div class="repo">
        GIT repo: <a href="https://github.com/LEOB3TA/issProject2023">https://github.com/LEOB3TA/issProject2023</a>
    </div>

</div>
</body>
</html>
